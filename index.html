<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نونة روحية - فصل تلمذة</title>

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">

    <style>
        /* كود CSS للرسائل */
        #message {
            margin-top: 15px;
            font-weight: bold;
            color: #333;
            text-align: center;
        }
        #message.success { color: green; }
        #message.error { color: red; }
        #message.loading { color: orange; }
        
        /* حالة الزر المعطل */
        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important; 
            box-shadow: none !important;
        }
    </style>
</head>

<body>

    <header>
        <h2>Kirellos George</h2>
    </header>

    <section class="hero">
        <img src="Screenshot_2025-11-26_201754-removebg-preview.png" alt="logo" class="logo">
        <h1>فصل تلمذة<br>نوتة روحية</h1>
        <p>ويب سايت مصمم لمتابعة النمو الروحي لفصول تلمذة</p>
    </section>

    <section class="form-section">

        <div class="row">
            <span>الاسم :</span>
            <input type="text" id="studentName" placeholder="اكتب اسمك هنا">
        </div>

        <div class="date-container">
            <input type="date" id="dateField">
        </div>

        <div class="row">
            <span>الإنجيل :</span>
            <div>
                <label>NO <input type="radio" name="gospel" value="No"></label>
                <label>YES <input type="radio" name="gospel" value="Yes"></label>
            </div>
        </div>

        <div class="row">
            <span>الاعتراف :</span>
            <div>
                <label>NO <input type="radio" name="confession" value="No"></label>
                <label>YES <input type="radio" name="confession" value="Yes"></label>
            </div>
        </div>

        <div class="row">
            <span>التناول :</span>
            <div>
                <label>NO <input type="radio" name="communion" value="No"></label>
                <label>YES <input type="radio" name="communion" value="Yes"></label>
            </div>
        </div>

        <div class="row">
            <span>توقيت القراءة/الصلاة :</span>
            <div>
                <label>باكر <input type="checkbox" name="readingTime" value="باكر"></label>
                <label>الغروب <input type="checkbox" name="readingTime" value="الغروب"></label>
                <label>النوم <input type="checkbox" name="readingTime" value="النوم"></label>
            </div>
        </div>

        <div class="row">
            <span>اختار اشبينك :</span>
            <select id="teacherSelect">
                <option value="">اختار اشبينك</option>
                <option value="استاذ بيشوي كامل">استاذ بيشوي كامل</option>
                <option value="استاذ ايميل">استاذ ايميل</option>
                <option value="استاذ جوزيف">استاذ جوزيف</option>
                <option value="استاذ بيشوي صبري">استاذ بيشوي صبري</option>
                <option value="طاسوني ميرنا">طاسوني ميرنا</option>
                <option value="طاسوني اولفت">طاسوني اولفت</option>
                <option value="طاسوني داليا">طاسوني داليا</option>
                <option value="طاسوني امال">طاسوني امال</option>
                <option value="طاسوني اوديت">طاسوني اوديت</option>
                <option value="طاسوني كريستين">طاسوني كريستين</option>
            </select>
        </div>

        <button class="submit-btn" id="submitButton">إرسال</button>
        <div id="message"></div>

    </section>

<script>
    const submitButton = document.getElementById("submitButton");
    let isSending = false;

    // رابط الـ Google Apps Script الخاص بك
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz6GL3CFFEyCH7GBP-I51LyTzMRVfmihfpX-ONCFwOKMBKJdzHbWibnErBSOhqAaJsB/exec";

    submitButton.addEventListener("click", async () => {
        if (isSending) return;

        const name = document.getElementById("studentName").value.trim();
        const date = document.getElementById("dateField").value;
        const teacher = document.getElementById("teacherSelect").value;
        const gospel = document.querySelector('input[name="gospel"]:checked')?.value;
        const confession = document.querySelector('input[name="confession"]:checked')?.value;
        const communion = document.querySelector('input[name="communion"]:checked')?.value;
        
        const selectedTimes = Array.from(document.querySelectorAll('input[name="readingTime"]:checked'))
            .map(checkbox => checkbox.value).join(", ");
        
        const prayer = selectedTimes || "لم يتم الاختيار"; 
        const messageBox = document.getElementById("message");

        // التحقق من الحقول
        if (!name || !date || !teacher || !gospel || !confession || !communion || prayer === "لم يتم الاختيار") {
            messageBox.textContent = "❌ من فضلك أكمل جميع الحقول المطلوبة";
            messageBox.className = "error";
            return;
        }

        isSending = true; 
        submitButton.disabled = true; 
        messageBox.textContent = "جارٍ الإرسال...";
        messageBox.className = "loading";

        try {
            const res = await fetch(
                SCRIPT_URL,
                {
                    method: "POST",
                    body: new URLSearchParams({
                        name, 
                        date, 
                        teacher, 
                        gospel, 
                        confession, 
                        communion, 
                        prayer
                    })
                }
            );

            const text = await res.text();
            messageBox.textContent = text;
            messageBox.className = text.includes("✔") ? "success" : "error";

        } catch (err) {
            messageBox.textContent = "❌ حدث خطأ أثناء الإرسال. الرجاء المحاولة لاحقًا.";
            messageBox.className = "error";
        } finally {
            isSending = false; 
            submitButton.disabled = false; 
        }
    });
</script>

</body>
</html>
